--1
SELECT name FROM Passenger

--2
SELECT name FROM Company

--3
SELECT * FROM Trip
WHERE town_from='Moscow'

--4
SELECT name FROM Passenger
WHERE name LIKE '%man'

--5
SELECT COUNT(*) as count FROM Trip
WHERE plane='TU-134'

--6
SELECT DISTINCT Company.name FROM Company
JOIN Trip ON (Company.id=Trip.company AND Trip.plane='Boeing')

--7
SELECT DISTINCT plane FROM Trip
WHERE town_to='Moscow'

--9
SELECT DISTINCT Company.name FROM Company
JOIN Trip ON (town_from='Vladivostok' AND Company.id=Trip.company)

--11
SELECT name FROM Passenger
 WHERE LENGTH (name) =
       (SELECT MAX (LENGTH (name)) FROM Passenger)

--12
SELECT trip, COUNT(passenger) as count 
FROM Pass_in_trip
GROUP BY trip

--13
SELECT name FROM Passenger
GROUP BY name
HAVING COUNT(name)>1 

--14
SELECT Trip.town_to FROM Pass_in_trip
JOIN Passenger ON (Pass_in_trip.passenger=Passenger.id AND Passenger.name='Bruce Willis')
JOIN Trip ON (Pass_in_trip.trip=Trip.id)

--16 
SELECT Passenger.name, COUNT(Pass_in_trip.trip) as count 
FROM  Pass_in_trip
JOIN Passenger ON (Passenger.id=Pass_in_trip.passenger) 
JOIN Trip ON (Trip.id=Pass_in_trip.trip)
GROUP BY Passenger.name
ORDER BY count DESC,
 Passenger.name ASC  

--19
SELECT DISTINCT FamilyMembers.status FROM Payments
JOIN FamilyMembers ON (FamilyMembers.member_id= Payments.family_member)
JOIN Goods ON (Goods.good_id=Payments.good 
AND Goods.good_name='potato')

--20
SELECT FamilyMembers.status, FamilyMembers.member_name, Payments.amount*Payments.unit_price AS costs
FROM Payments
JOIN FamilyMembers ON (Payments.family_member=FamilyMembers.member_id)
JOIN Goods ON (Payments.good=Goods.good_id
AND Goods.type=( SELECT Goods.type FROM Goods
JOIN GoodTypes ON (Goods.type=GoodTypes.good_type_id AND 
GoodTypes.good_type_name='entertainment') ))

--21
SELECT Goods.good_name FROM Goods
JOIN Payments ON (Payments.good=Goods.good_id)
GROUP BY Payments.good
HAVING COUNT(Payments.good)>1
